# CicadaGallery - 動画ギャラリープレイヤー

Rust製の動画管理・再生アプリケーションです。MPVプレイヤーを使用して高品質な動画再生を実現します。

📖 **ドキュメント**: [https://tetdarth.github.io/CicadaGallery/](https://tetdarth.github.io/CicadaGallery/)

## 機能

### 基本機能（無料版）
- 📁 **ファイル・ディレクトリ追加**: 動画ファイルを個別またはフォルダごとに追加
- 🖱️ **ドラッグ＆ドロップ**: 動画やフォルダをドラッグ＆ドロップで追加
- 🏷️ **タグ付け**: 動画にタグを付けて整理
- 📂 **フォルダ分け**: 動画を仮想フォルダで分類・管理
- ⭐ **お気に入り機能**: お気に入りの動画をマーク
- 🔍 **検索機能**: タイトルやタグで動画を検索
- 💾 **SQLiteデータベース**: 動画情報を軽量なSQLiteで管理
- 🖼️ **サムネイル生成**: FFmpegによる自動サムネイル生成
- 🌍 **多言語対応**: 英語、日本語、中国語に対応
- 🎨 **カスタマイズ可能**: ダークモード、サムネイルサイズ調整など
- 📺 **MPV統合**: 高性能なMPVプレイヤーで動画再生
- 🔊 **音量設定**: デフォルト音量を設定可能
- 📏 **ウィンドウサイズ記憶**: 終了時のウィンドウサイズ・位置を保存
- 👁️ **フォルダ監視**: 登録フォルダの変更を自動検知

### プレミアム機能
- 🎬 **シーン検出**: 動画のシーン変化を自動検出してサムネイル生成
- ⭐ **1-5星評価**: 5段階の評価システム
- 🎨 **GLSLシェーダー**: Anime4Kなどのカスタムシェーダー対応
- 🖥️ **GPU高品質レンダリング**: MPVのgpu-hqプロファイル
- ♾️ **無制限の動画登録**: 100本以上の動画を登録可能
- ✅ **フォルダ/タグの複数選択**: 複数のフォルダやタグでフィルタリング
- 🔀 **AND/ORフィルターモード**: タグのAND/OR条件切り替え

## サポートする動画形式

MP4, AVI, MKV, MOV, WMV, FLV, WebM, M4V, MPG, MPEG

## 依存関係

このアプリケーションは以下の外部ツールを必要とします：

### MPV (必須)

動画再生にMPVを使用しています。プロジェクトの `mpv/` フォルダに同梱されています。

### FFmpeg (推奨)

サムネイル生成と動画解析に使用されます。プロジェクトの `ffmpeg/` フォルダに同梱されています。

## 実行方法

```bash
cd CicadaGallery
cargo run
```

## ビルド

### 無料版（オープンソース）
```bash
cargo build --release
```

> 公開リポジトリからビルドした場合、プレミアム機能は使用できません。

実行可能ファイルは `target/release/cicada_gallery.exe` に生成されます。

## 使い方

### 基本操作
1. **ファイル追加**: トップバーの「📁 ファイル追加」ボタンをクリック、またはエクスプローラーからドラッグ&ドロップ
2. **フォルダ追加**: トップバーの「📂 フォルダ追加」ボタンをクリック、またはエクスプローラーからドラッグ&ドロップ
3. **動画再生**: サムネイルをクリック（MPVで再生）
4. **複数選択**: Ctrl+クリックで複数選択、Shift+クリックで範囲選択
5. **お気に入り**: ⭐ボタンをクリックしてお気に入りに追加
6. **フィルタリング**: サイドバーでフォルダやタグでフィルタリング
7. **表示切替**: グリッド表示とリスト表示を切り替え可能

### 管理機能
- **フォルダ管理**: オプション → フォルダを管理... でフォルダの追加・削除
- **タグ管理**: オプション → タグを管理... でタグの追加・削除
- **シェーダー管理**: オプション → シェーダーを管理... でGLSLシェーダー選択 (プレミアム機能)

### キーボードショートカット（MPVプレイヤー内）
- `Space`: 再生/一時停止
- `←/→`: 5秒巻き戻し/早送り
- `↑/↓`: 音量調整
- `f`: フルスクリーン切替
- `q`: プレイヤー終了

## 技術スタック

- **GUI**: egui / eframe
- **データベース**: SQLite (rusqlite)
- **シリアライゼーション**: serde / serde_json
- **ファイルダイアログ**: rfd
- **日時処理**: chrono
- **ファイル監視**: notify
- **ライセンス認証**: ed25519-dalek

## データ保存場所

- **データベース**: `%LOCALAPPDATA%\CicadaGallery\database.db`
- **設定ファイル**: `%LOCALAPPDATA%\CicadaGallery\settings.json`
- **シーンキャッシュ**: `cache/scenes/`

## 言語設定

1. トップバーの「Options」（オプション）ボタンをクリック
2. 「Language」セクションで希望の言語を選択
   - English (英語)
   - 日本語
3. 設定は自動的に保存されます

## ライセンス認証

プレミアム機能を利用するには、ライセンスキーが必要です。

1. 「ライセンスキーを入力」ボタンをクリック
2. ライセンスキーを貼り付けて「有効化」をクリック
3. 認証が成功するとプレミアム機能が有効になります

## 今後の拡張予定

- プレイリスト機能
- より詳細な検索・フィルタ機能
- スマートコレクション
